<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <meta name="theme-color" content="#050505">
  <title>ORBYTE — mobile hero</title>

  <link rel="stylesheet"
        href="https://use.typekit.net/fdb0pds.css">
  <style>
    /* — BASE — */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;background:#050505;color:#fff;
              font-family:itc-avant-garde-gothic-pro,sans-serif;
              overflow-x:hidden}
    a{color:#fff;text-decoration:none;border-bottom:1px solid}

    /* — CANVAS — */
    #globeCanvas{position:fixed;inset:0;z-index:0;pointer-events:none;
                 opacity:0;transition:opacity 1s}

    /* — LOADER — */
    #loader{position:fixed;inset:0;background:#000;display:flex;
            flex-direction:column;align-items:center;justify-content:center;
            z-index:900;transition:opacity .6s,visibility .6s}
    #loader.hidden{opacity:0;visibility:hidden}
    .ring{width:48px;height:48px;border:2px solid #333;
          border-top:2px solid #fff;border-radius:50%;
          animation:spin 1s linear infinite;margin-bottom:12px}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* — NAV — */
    nav{position:fixed;top:0;left:0;width:100%;padding:26px;
        display:flex;justify-content:space-between;align-items:center;
        mix-blend-mode:difference;z-index:50}
    .logo{font-weight:700;font-size:20px;letter-spacing:-1px}
    .navBtn{border:1px solid rgba(255,255,255,.5);background:none;
            padding:8px 24px;border-radius:40px;font-size:12px;
            text-transform:uppercase;letter-spacing:1px;color:#fff;
            cursor:pointer}

    /* — SECTIONS — */
    main{position:relative;z-index:10}
    .section{min-height:100vh;display:flex;align-items:center;
             padding:0 8vw;pointer-events:none}
    .right  {margin-left:auto;text-align:right}
    .center {margin:0 auto;text-align:center}
    .box{max-width:600px;opacity:0;transform:translateY(30px);pointer-events:auto}
    .huge{font-weight:700;font-size:clamp(2.3rem,8vw,4.8rem);
          line-height:.95;letter-spacing:-.02em;margin-bottom:20px}
    .label{font-size:11px;letter-spacing:2px;opacity:.75;margin-bottom:15px}

    @media(max-width:768px){
      nav{padding:20px}
      .section{padding:0 7vw}
    }
  </style>
</head>
<body>

  <!-- Loader -->
  <div id="loader">
    <div class="ring"></div>
    <div style="font-size:10px;letter-spacing:3px;color:#666">INITIALIZING</div>
  </div>

  <!-- Nav -->
  <nav>
    <a href="#" class="logo">O R B Y T E</a>
    <button class="navBtn" onclick="scrollToLabel('contact')">Contact</button>
  </nav>

  <!-- Globe Canvas -->
  <div id="globeCanvas"></div>

  <!-- Copy -->
  <main id="content">
    <section class="section" data-label="hero">
      <div class="box">
        <span class="label">MAIN</span>
        <h1 class="huge uppercase">WE CREATE<br>USER EXPERIENCES.</h1>
      </div>
    </section>

    <section class="section" data-label="about">
      <div class="box right">
        <span class="label">ABOUT US</span>
        <h1 class="huge uppercase">GLOBAL DESIGN<br>&amp; DEVELOPMENT.</h1>
      </div>
    </section>

    <section class="section" data-label="services">
      <div class="box">
        <span class="label">SERVICES</span>
        <h1 class="huge uppercase">SCALABLE<br>DIGITAL ENVIRONMENTS.</h1>
      </div>
    </section>

    <section class="section" data-label="realism">
      <div class="box center">
        <span class="label">CAPABILITIES</span>
        <h1 class="huge uppercase">THREE-DIMENSIONAL<br>REALISM.</h1>
      </div>
    </section>

    <section class="section" data-label="contact">
      <div class="box center">
        <h1 class="huge uppercase">SEND US<br>YOUR QUERY.</h1>
        <a href="mailto:contact@orbyte.studio">contact@orbyte.studio</a>
      </div>
    </section>
    <div style="height:50vh"></div>
  </main>

  <!-- LIBS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollToPlugin.min.js"></script>
  <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
  <script src="https://unpkg.com/globe.gl@4.5.7/dist/globe.gl.min.js"></script>

  <script>
  /* ------------------------------------------------------------------
      1.  PRE-LOADER FAILSAFE
  ------------------------------------------------------------------ */
  const loaderEl  = document.getElementById('loader');
  const canvasEl  = document.getElementById('globeCanvas');
  const LATE_FAIL = setTimeout(hideLoader, 5000);   // never stay forever

  function hideLoader(){
    loaderEl.classList.add('hidden');
    canvasEl.classList.add('visible');
  }

  /* ------------------------------------------------------------------
      2.  THREE + Globe.gl  (zero CORS issues)
  ------------------------------------------------------------------ */
  const Globe = window.Globe;
  const globeObj = Globe()
    (canvasEl)
      .globeImageUrl('//unpkg.com/globe.gl/example/img/earth-dark.jpg')
      .bumpImageUrl ('//unpkg.com/globe.gl/example/img/earth-topology.png')
      .cloudsData([{ lat:0, lng:0, alt:0 }])        // enable cloud shader
      .cloudAltitude(0.01)
      .atmosphereAltitude(0.07)
      .enablePointerInteraction(false)
      .onGlobeReady(()=>{
         clearTimeout(LATE_FAIL);
         hideLoader();
         buildTimeline();            // start GSAP when textures ready
         animate();
      });

  /*  hand-tune initial cam */
  const THREE     = window.THREE;
  const gRenderer = globeObj.renderer();
  const gScene    = globeObj.scene();
  const gCamera   = globeObj.camera();
  gCamera.position.set(0,0,350);     // Globe.gl units are km by default
  gRenderer.setPixelRatio(Math.min(devicePixelRatio, 1.5));

  /* small star-field */
  {
    const starGeo=new THREE.BufferGeometry();
    const starPos=[];
    for(let i=0;i<800;i++) starPos.push((Math.random()-.5)*1000,
                                        (Math.random()-.5)*1000,
                                        (Math.random()-.5)*1000);
    starGeo.setAttribute('position',new THREE.Float32BufferAttribute(starPos,3));
    const stars=new THREE.Points(starGeo,new THREE.PointsMaterial({color:0xffffff,size:1}));
    gScene.add(stars);
  }

  /* ------------------------------------------------------------------
      3.  KEYFRAMES  (km units to match Globe.gl)
  ------------------------------------------------------------------ */
  const KF = {
    hero    : { pos:[  0,   0,   0], camZ:350, rot:0   },
    about   : { pos:[  0,   0,-800], camZ:350, rot:120 },
    services: { pos:[400,-200,-500], camZ:350, rot:240 },
    realism : { pos:[  0,   0,   0], camZ:350, rot:360 },
    contact : { pos:[  0,   0,-900], camZ:420, rot:450 }
  };

  /* ------------------------------------------------------------------
      4.  GSAP TIMELINE & SECTION REVEALS
  ------------------------------------------------------------------ */
  gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);
  let tl;

  function buildTimeline(){
    tl && tl.kill();
    tl = gsap.timeline({
      defaults:{ease:'none'},
      scrollTrigger:{
        trigger:'#content',
        start:'top top',
        end:'bottom bottom',
        scrub:1,
        snap:{ snapTo:'labels', duration:{min:.2,max:.8}}
      }
    });

    add('hero'   , KF.hero);
    add('about'  , KF.about);
    add('services',KF.services);
    add('realism', KF.realism);
    add('contact', KF.contact, ()=> gsap.to('#globeCanvas',{opacity:.3,duration:2}));
  }

  function add(label,kf,extra){
    tl.addLabel(label)
      .to(globeObj.pointOfView, {
        lat:0, lng:kf.rot, altitude:kf.camZ/1000,     // altitude in globe units
        duration:2, ease:'power2.inOut',
        onUpdate:function(){
          const v=this.targets()[0];
          globeObj.pointOfView({lat:0,lng:v.lng,altitude:v.altitude});
          globeObj.rotationY(d2r(kf.rot));
        }
      },'<')
      .to(globeObj.rotation, {y:d2r(kf.rot), duration:2, ease:'power2.inOut'}, '<');
    extra && extra();
  }
  function d2r(d){return d*Math.PI/180;}

  /* section boxes fade in */
  document.querySelectorAll('.box').forEach(box=>{
    gsap.to(box,{opacity:1,y:0,duration:.8,
      scrollTrigger:{trigger:box.parentElement,start:'top 60%',toggleActions:'play reverse play reverse'}
    });
  });

  /* ------------------------------------------------------------------
      5.  RENDER LOOP
  ------------------------------------------------------------------ */
  function animate(){
    globeObj.rotationY(globeObj.rotationY()+0.0008);
    globeObj.render();
    requestAnimationFrame(animate);
  }

  /* ------------------------------------------------------------------
      6.  HELPERS
  ------------------------------------------------------------------ */
  window.scrollToLabel = label =>
    gsap.to(window,{duration:1.2,
      scrollTo:{y:`[data-label="${label}"]`,autoKill:false},ease:'power2.inOut'});
  </script>
</body>
</html>
